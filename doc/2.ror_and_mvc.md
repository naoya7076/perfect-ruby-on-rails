# 2. Ruby on RailsとMVC
## 2.1 MVCアーキテクチャ

- M = Model
  - データベースとの接続とデータに対する操作、およびビジネスロジック
- V = View
  - Modelの内容を参照し視覚表現を行う部分
- C = Controller
  - Modelのロジック呼び出し、必要なViewの選択など、ModelとViewを繋ぐ部分

### 2.1.2 モデルの基礎と考え方
#### モデルとモデリング
題材の「書籍管理アプリ」に必要なモノやコトについて考えてみます。まずはこのシステムに登場する登場人物について検討する
- 書籍に関する情報
- 出版社に関する情報
- 著者に関する情報
- 管理者に関する情報

#### ActiveRecordで書籍モデルを実装する
- 書名
- 発売日
- 価格
- 著者
- 出版社

`bin/rails g model Book name:string published_on:date price:integer`

**ActiveRecordによるモデルの2つの側面**
1. DBと接続し、DBのレコードとActiveRecordオブジェクトを結びつける
2. バリデーションや、レコード保存時などに実行する様々なコールバックを実行する役割

**補足**

[Active Record コールバック](https://railsguides.jp/active_record_callbacks.html)

## 2.2 モデルを扱う
書籍モデルをrails consoleから操作してActiveRecordの基本的な使い方を学ぶ

- primary key以外で検索するとき
```
> Book.find_by(name: "Book 3")
```
戻り値はBookクラスのインスタンス

#### ActiveRecord::Relationについて
ActiveRecord:Relationは、メソッド呼び出しを通じてActiveRecord::Relation内部でどのようなSQLを発行するのか、という情報だけを保持する。実際にSQLの実行結果が必要になるまではデータベースに対するアクセスは発生しない。明示的に任意の箇所でSQLを発行したい場合は、`to_a`メソッドを呼び出して即座にSQLを発行するというテクニックもある。

#### scopeを定義する
Scopeとは、よく利用する検索条件に名前をつけてひとまとめにしたもの。

